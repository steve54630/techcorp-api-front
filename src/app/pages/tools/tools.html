<form
  [formGroup]="searchForm"
  role="search"
  class="flex flex-col lg:flex-row items-baseline gap-4 lg:gap-10 p-4 lg:p-0 border-b lg:border-none"
>
  <div class="flex flex-col sm:flex-row items-start sm:items-baseline gap-2 sm:gap-10 w-full lg:w-auto">
    <h4 class="text-lg sm:text-2xl font-bold flex flex-row gap-2 text-gray-800">
      <lucide-angular name="building-2" size="24" class="sm:w-30 sm:h-30"></lucide-angular>Department
    </h4>
    <mat-form-field class="w-full sm:w-auto">
      <mat-label>Choose a department</mat-label>
      <mat-select formControlName="department">
        <mat-option value="all">All</mat-option>
        @if(departments$ | async; as departments) { @for (department of
        departments; track $index) {
        <mat-option value="{{ department.name }}">{{ department.name }}</mat-option>
        } }
      </mat-select>
    </mat-form-field>
  </div>


  <div class="flex flex-col sm:flex-row items-start sm:items-baseline gap-2 sm:gap-10 w-full lg:w-auto">
    <h4 class="text-lg sm:text-2xl font-bold flex flex-row gap-2 text-gray-800">
      <lucide-angular name="settings" size="24" class="sm:w-30 sm:h-30"></lucide-angular>Categories
    </h4>
    <mat-form-field class="w-full sm:w-auto">
      <mat-label>Choose a category</mat-label>
      <mat-select formControlName="categories">
        <mat-option value="all">All</mat-option>
        @if(categories$ | async; as categories) { @for (category of categories;
        track $index) {
        <mat-option value="{{ category }}">{{ category }}</mat-option>
        } }
      </mat-select>
    </mat-form-field>
  </div>


  <div class="flex flex-col sm:flex-row items-start sm:items-baseline gap-2 sm:gap-10 w-full lg:w-auto">
    <h4 class="text-lg sm:text-2xl font-bold flex flex-row gap-2 text-gray-800">
      <lucide-angular name="badge" size="24" class="sm:w-30 sm:h-30"></lucide-angular>Status
    </h4>
    <mat-form-field class="w-full sm:w-auto">
      <mat-label>Choose a status</mat-label>
      <mat-select formControlName="status">
        <mat-option value="all">All</mat-option>
        <mat-option value="expiring">Expiring</mat-option>
        <mat-option value="active">Active</mat-option>
        <mat-option value="unused">Unused </mat-option>
      </mat-select>
    </mat-form-field>
  </div>


  <div class="flex flex-col w-full lg:w-auto">
    <h4 class="text-lg sm:text-2xl font-bold flex flex-row gap-2 text-gray-800 mb-2 sm:mb-0">
      Cost Range
    </h4>

    @let minValue = minPrice$ | async; @let maxValue = maxPrice$ | async;
    @if(minValue! <=0 && maxValue) {
      <div class="flex flex-col sm:flex-row gap-4 sm:gap-10 justify-between sm:justify-baseline items-center w-full">
        <p class="text-sm sm:text-base">Min Cost: {{ searchForm.value.minPrice }}</p>
        
        <mat-slider min="0" [max]="maxValue" class="w-full sm:w-auto min-w-[150px]">
          <input matSliderStartThumb [formControlName]="'minPrice'" />
          <input matSliderEndThumb [formControlName]="'maxPrice'" />
        </mat-slider>
        
        <p class="text-sm sm:text-base">Max Cost: {{ searchForm.value.maxPrice }}</p>
      </div>
    } @else {
      <p class="text-sm">Waiting for maxPrice$</p>
    }
  </div>
</form>

@if (filteredTools$ | async; as tools) { @if (query$ | async; as query) {
<app-tools-table
  [tools]="tools"
  [query]="query"
  (sortChanged)="onSortChange($event)"
  (pageChange)="onPageChange($event)"
  [resume]="false"
  [title]="'All Tools'"
  [totalCount]="totalCount$ | async"
/>
} }